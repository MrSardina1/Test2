<div class="password-container">
  <div class="password-card">
    <div class="password-header">
      <div class="header-icon">
        <i class="bi bi-shield-lock"></i>
      </div>
      <h2>Change Password</h2>
      <p class="text-muted">Update your account security</p>
    </div>

    <div *ngIf="message" class="alert" [ngClass]="{'alert-success': message.includes('successfully'), 'alert-danger': !message.includes('successfully')}">
      <i class="bi" [ngClass]="{'bi-check-circle': message.includes('successfully'), 'bi-exclamation-circle': !message.includes('successfully')}"></i>
      {{ message }}
    </div>

    <form (submit)="updatePassword(); $event.preventDefault()" class="password-form">
      <div class="mb-4">
        <label class="form-label">Current Password</label>
        <div class="input-group">
          <span class="input-group-text">
            <i class="bi bi-key"></i>
          </span>
          <input
            [type]="showOldPassword ? 'text' : 'password'"
            class="form-control"
            [(ngModel)]="oldPassword"
            name="oldPassword"
            placeholder="Enter your current password"
            required
          />
          <button type="button" class="btn btn-outline-secondary" (click)="showOldPassword = !showOldPassword">
            <i class="bi" [ngClass]="showOldPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
          </button>
        </div>
      </div>

      <div class="mb-4">
        <label class="form-label">New Password</label>
        <div class="input-group">
          <span class="input-group-text">
            <i class="bi bi-lock"></i>
          </span>
          <input
            [type]="showNewPassword ? 'text' : 'password'"
            class="form-control"
            [(ngModel)]="newPassword"
            name="newPassword"
            placeholder="Enter your new password"
            required
          />
          <button type="button" class="btn btn-outline-secondary" (click)="showNewPassword = !showNewPassword">
            <i class="bi" [ngClass]="showNewPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
          </button>
        </div>
      </div>

      <div class="mb-4">
        <label class="form-label">Confirm New Password</label>
        <div class="input-group">
          <span class="input-group-text">
            <i class="bi bi-lock-fill"></i>
          </span>
          <input
            [type]="showConfirmPassword ? 'text' : 'password'"
            class="form-control"
            [(ngModel)]="confirmPassword"
            name="confirmPassword"
            placeholder="Confirm your new password"
            required
          />
          <button type="button" class="btn btn-outline-secondary" (click)="showConfirmPassword = !showConfirmPassword">
            <i class="bi" [ngClass]="showConfirmPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
          </button>
        </div>
        <small *ngIf="confirmPassword && newPassword !== confirmPassword" class="text-danger">
          <i class="bi bi-x-circle"></i> Passwords do not match
        </small>
      </div>

      <div class="password-requirements mb-4">
        <p class="mb-2"><strong>Password Requirements:</strong></p>
        <ul>
          <li [ngClass]="{'text-success': newPassword.length >= 6, 'text-muted': newPassword.length < 6}">
            <i class="bi" [ngClass]="newPassword.length >= 6 ? 'bi-check-circle-fill' : 'bi-circle'"></i>
            At least 6 characters
          </li>
          <li [ngClass]="{'text-success': hasNumber(newPassword), 'text-muted': !hasNumber(newPassword)}">
            <i class="bi" [ngClass]="hasNumber(newPassword) ? 'bi-check-circle-fill' : 'bi-circle'"></i>
            Contains a number
          </li>
          <li [ngClass]="{'text-success': hasUppercase(newPassword), 'text-muted': !hasUppercase(newPassword)}">
            <i class="bi" [ngClass]="hasUppercase(newPassword) ? 'bi-check-circle-fill' : 'bi-circle'"></i>
            Contains an uppercase letter
          </li>
        </ul>
      </div>

      <div class="d-grid">
        <button type="submit" class="btn btn-primary btn-lg" [disabled]="isLoading">
          <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-2"></span>
          <i *ngIf="!isLoading" class="bi bi-check2-circle me-2"></i>
          {{ isLoading ? 'Updating...' : 'Update Password' }}
        </button>
      </div>
    </form>

    <div class="password-footer">
      <p class="text-muted mb-0">
        <i class="bi bi-info-circle me-1"></i>
        Make sure to remember your new password
      </p>
    </div>
  </div>
</div>
